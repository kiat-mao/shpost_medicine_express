<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <%= stylesheet_link_tag "application", :media => "all" %>
          <%= javascript_include_tag "application" %>

    <object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0> 
        <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop.exe"></embed>
    </object>

    <script language="javascript" type="text/javascript">
    function zxqd_preview(){
      LODOP=getLodop(document.getElementById('LODOP_OB'),document.getElementById('LODOP_EM'));  
      if(LODOP == undefined){
          window.open("/CLodop_Setup_for_Win64NT.exe");
      }
      if(!LODOP.hasOwnProperty('PRINT') && (LODOP.VERSION == undefined)){
          window.open("/install_lodop32.exe");
      }
      LODOP.SET_LICENSES("上海市邮政公司信息技术局","452677782688188907989821905623","","");
      LODOP.SET_PRINT_PAGESIZE(1,"210mm","297mm","");
      LODOP.PRINT_INIT("打印装箱清单");
      h=10;
    <% Bag.where("id>3").each do |b| %>
    LODOP.ADD_PRINT_BARCODE(h,"20mm","50mm","10mm","128A","<%= b.bag_no %>");
    h+=80;
    <% end %>
    LODOP.PREVIEW();
    };
    </script>
  </head>
  
  <body onLoad="zxqd_preview();window.opener=null;window.open('','_top');window.top.close(); ">

  </body>
</html>