<!DOCTYPE HTML>
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<%= stylesheet_link_tag "application", :media => "all" %>
      <%= javascript_include_tag "application" %>

<object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
  <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop.exe"></embed>
</object>

  <script language="javascript" type="text/javascript">
  function tkzd_preview() {

    LODOP=getLodop(document.getElementById('LODOP_OB'),document.getElementById('LODOP_EM'));
    if(LODOP == undefined){
        window.open("/CLodop_Setup_for_Win64NT.exe");
    }
    if(!LODOP.hasOwnProperty('PRINT') && (LODOP.VERSION == undefined)){
        window.open("/install_lodop32.exe");
    }
    LODOP.SET_LICENSES("上海市邮政公司信息技术局","452677782688188907989821905623","","");
    <% @result.sort_by{|x| x.package_no.upcase}.each do |package| %>
    LODOP.PRINT_INIT("打印特快专递单");
    LODOP.SET_PRINT_PAGESIZE(1,750,1300,"tkzd");
    LODOP.ADD_PRINT_LINE("2mm","2mm","2mm","74mm",2,1);
    LODOP.ADD_PRINT_TEXT("2.4mm","4mm","11.11mm","7.67mm","EMS");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",14);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("2.8mm","24mm","30mm","6.61mm","特快专递");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",14);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("2.8mm","55mm","30.43mm","5.29mm","客服电话：11183");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("6.2mm","55mm","29.1mm","5.29mm","www.ems.com.cn");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_BARCODE("10mm","2.4mm","72mm","14mm","128A","<%= package.express_no %>");
    LODOP.ADD_PRINT_LINE("26mm","2mm","26mm","74mm",2,1);
    
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("29.5mm","2mm","72mm","14mm","格口码: <%= package.route_code %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",10);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_LINE("35mm","2mm","35mm","74mm",2,1);
    LODOP.ADD_PRINT_TEXT("36mm","2mm","36mm","7mm","收件人姓名: <%= package.orders.first.receiver_name %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",8);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("36mm","36mm","36mm","7mm","收件人电话: <%= package.orders.first.receiver_phone %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",8);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("43mm","2mm","72mm","7mm","收件人地址: <%= package.orders.first.receiver_addr %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",8);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_LINE("49mm","2mm","49mm","74mm",2,1);
    LODOP.ADD_PRINT_TEXT("49.2mm","2mm","36mm","4mm","寄件人姓名: <%= package.orders.first.sender_name %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("49.2mm","36mm","36mm","4mm","寄件人电话: <%= package.orders.first.sender_phone %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("53.2mm","2mm","72mm","4mm","寄件人地址: <%= package.orders.first.sender_addr %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_LINE("57mm","2mm","57mm","74mm",2,1);
    LODOP.ADD_PRINT_TEXT("58mm","2mm","36mm","4mm","实际重量:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("58mm","36mm","36mm","4mm","体积(cm):");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("62mm","2mm","36mm","4mm","邮费:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("62mm","36mm","36mm","4mm","保价金额:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("66mm","2mm","36mm","4mm","其他费用:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("66mm","36mm","36mm","4mm","实收金额:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",12);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_LINE("70mm","2mm","70mm","74mm",2,1);
    LODOP.ADD_PRINT_LINE("73mm","2mm","73mm","74mm",2,1);
    LODOP.ADD_PRINT_TEXT("98mm","3mm","49mm","4mm","客服电话专线:");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("102mm","3mm","49mm","4mm","66110271");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("106mm","3mm","49mm","4mm","已验视");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("110mm","3mm","49mm","4mm","已安检");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("114mm","3mm","49mm","4mm","已消毒");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("90mm","49.2mm","23mm","4mm","打印时间:<%= Time.now.strftime("%Y-%m-%d %H:%M:%S") %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("98mm","49.2mm","23mm","4mm","编号: <%= package.package_no.split('-').last %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_TEXT("106mm","49.2mm","23mm","4mm","打印账号: <%= current_user.name %>");
    LODOP.SET_PRINT_STYLEA(0,"FontSize",6);
    LODOP.SET_PRINT_STYLEA(0,"Bold",1);
    LODOP.SET_PRINT_STYLEA(0,"FontName","黑体");
    LODOP.ADD_PRINT_LINE("124mm","2mm","124mm","74mm",2,1);
    LODOP.ADD_PRINT_LINE("127mm","2mm","127mm","74mm",2,1);
    // 竖线
    LODOP.ADD_PRINT_LINE("2mm","2mm","127mm","2mm",2,1);
    LODOP.ADD_PRINT_LINE("73mm","49mm","127mm","49mm",2,1);
    LODOP.ADD_PRINT_LINE("2mm","74mm","127mm","74mm",2,1);

    //设置某个打印机
    LODOP.SET_PRINTER_INDEXA("<%= current_user.hot_printer.blank? ? I18n.t('printer.hot_printer') : current_user.hot_printer %>");
    // LODOP.PRINT_DESIGN();
     LODOP.PREVIEW();
    // LODOP.PRINT();
    <% end %>
   };

  </script>

</head>

  <body onLoad="tkzd_preview();window.opener=null;window.open('','_top'); window.top.close();">

  </body>
</html>
